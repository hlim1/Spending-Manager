<!DOCTYPE html>
<html>
  <head>
    <title>SpendingManager</title>
    <!--Bootstrap CDN for compiled CSS and JS.-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <!--Bootstrap CDN for compiled Javascript in order to use jQuery.-->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

    <!--include gon gem for javascript-->
    <%= Gon::Base.render_data %>

    <!--jQuery-ui-->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    
    <!--chart-->
    <%= javascript_include_tag "https://www.gstatic.com/charts/loader.js" %>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart']});

      google.charts.setOnLoadCallback(piechart_for_spending_types);
      google.charts.setOnLoadCallback(linechart_for_monthly_spending);
      google.charts.setOnLoadCallback(barchart_for_current_balances);

      document.addEventListener('turbolinks:load', function piechart_for_spending_types() {

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Type');
        data.addColumn('number', 'Frequency');
        data.addRows(gon.spendingTypes);

        var options = {
          title: 'Expenses on Types',
          titleTextStyle: { color: 'black',
                            fontSize: 20,
                            bold: true},
          is3D: true
        };

        var chart = new google.visualization.PieChart(document.getElementById('piechart_for_spending_types'));
        chart.draw(data, options);
      })

      document.addEventListener('turbolinks:load', function linechart_for_monthly_spending() {

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Month');
        data.addColumn('number', 'Total');
        data.addRows(gon.mTotals);

        var options = {
          title: 'Monthly Total Spending',
          hAxis: {
            title: 'Month',
            titleTextStyle: { color: 'black',
                              bold: true
                            }
          },
          vAxis: {
            title: 'Amount ($)',
            titleTextStyle: { color: 'black',
                              bold: true
                            },
            gridlines: {
              count: 10
            }
          },
          titleTextStyle: { color: 'black',
                            fontSize: 20 }
        };

        var chart = new google.visualization.LineChart(document.getElementById('linechart_for_monthly_spending'));

        chart.draw(data, options);
      })

      function barchart_for_current_balances() {

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Institution');
        data.addColumn('number', 'Current Balance');
        data.addRows(gon.balanceSummary);

        var options = {
          title: 'Current Balance by Institution',
          titleTextStyle: { color: 'black',
                            fontSize: 20,
                            bold: true
                          },
          chartArea: {width: '50%'},
          hAxis: {
            title: 'Currenct Balance',
            titleTextStyle: { color: 'black',
                              bold: true
                            },
            minValue: 0
          },
          vAxis: {
            title: 'Institutions',
            titleTextStyle: { color: 'black',
                              bold: true
                            }
          },
        };

        var chart = new google.visualization.BarChart(document.getElementById('barchart_for_current_balances'));

        chart.draw(data, options);
      }
    </script>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <%= csrf_meta_tags %>

  </head>

  <body>
    <%= yield %>
  </body>
</html>
